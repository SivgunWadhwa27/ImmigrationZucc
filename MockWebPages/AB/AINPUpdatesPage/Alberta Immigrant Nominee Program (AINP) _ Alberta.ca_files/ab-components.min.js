abComponents=new function(){var e=this;e.settings={debug:!1},e.queryString={},e.data={language:"en-CA",media:"screen",locations:[]},this.ui=new function(){this.locations=new function(){e.settings.debug&&console.log("[abComponents] ui.locations");var t=this;t.version="1.0",t.data=[],t.geometry=[],t.labels={"en-CA":{open:"Open",address:"Address",contact:"Contact",email:"Email",phone:"Phone",fax:"Fax",tollfree:"Toll-free",tty:"TTY",website:"Website",select:"Select your location",showing:"Showing {name}",details:"Show {name} details",marker:"Show {name} marker on map",google:"Visit {name} on Google Maps for more options",update:"Update",clear:"Clear",all:"All locations",location:"location",locations:"locations"},"fr-CA":{open:"Open",address:"Address",contact:"Contact",email:"Email",phone:"Phone",fax:"Fax",tollfree:"Toll-free",tty:"TTY",website:"Website",select:"Select your location",showing:"Showing {name}",details:"Show {name} details",marker:"Show {name} marker on map",google:"Visit {name} on Google Maps for more options",update:"Update",clear:"Clear",all:"All locations",location:"location",locations:"locations"},"zh-CN":{open:"Open",address:"Address",contact:"Contact",email:"Email",phone:"Phone",fax:"Fax",tollfree:"Toll-free",tty:"TTY",website:"Website",select:"Select your location",showing:"Showing {name}",details:"Show {name} details",marker:"Show {name} marker on map",google:"Visit {name} on Google Maps for more options",update:"Update",clear:"Clear",all:"All locations",location:"location",locations:"locations"},"zh-TW":{open:"Open",address:"Address",contact:"Contact",email:"Email",phone:"Phone",fax:"Fax",tollfree:"Toll-free",tty:"TTY",website:"Website",select:"Select your location",showing:"Showing {name}",details:"Show {name} details",marker:"Show {name} marker on map",google:"Visit {name} on Google Maps for more options",update:"Update",clear:"Clear",all:"All locations",location:"location",locations:"locations"},"es-MX":{open:"Open",address:"Address",contact:"Contact",email:"Email",phone:"Phone",fax:"Fax",tollfree:"Toll-free",tty:"TTY",website:"Website",select:"Select your location",showing:"Showing {name}",details:"Show {name} details",marker:"Show {name} marker on map",google:"Visit {name} on Google Maps for more options",update:"Update",clear:"Clear",all:"All locations",location:"location",locations:"locations"},"pa-IN":{open:"Open",address:"Address",contact:"Contact",email:"Email",phone:"Phone",fax:"Fax",tollfree:"Toll-free",tty:"TTY",website:"Website",select:"Select your location",showing:"Showing {name}",details:"Show {name} details",marker:"Show {name} marker on map",google:"Visit {name} on Google Maps for more options",update:"Update",clear:"Clear",all:"All locations",location:"location",locations:"locations"},"ar-JO":{open:"Open",address:"Address",contact:"Contact",email:"Email",phone:"Phone",fax:"Fax",tollfree:"Toll-free",tty:"TTY",website:"Website",select:"Select your location",showing:"Showing {name}",details:"Show {name} details",marker:"Show {name} marker on map",google:"Visit {name} on Google Maps for more options",update:"Update",clear:"Clear",all:"All locations",location:"location",locations:"locations"}},t.init=function(){e.settings.debug&&console.log("[abComponents] ui.locations.init");for(var a=document.querySelectorAll("div.ab-c-locations"),o=0;o<a.length;o++){var n=a[o].querySelector("ul");(c=document.createElement("a")).name="ab-locations"+o,a[o].parentNode.insertBefore(c,a[o]);var l=t.addMap({list:n,components:a,component:a[o],count:o});t.data[o]=[],t.geometry[o]=[];for(var i=a[o].querySelectorAll("li.ab-c-location"),r=t.addFilter({map:l,components:a,component:a[o],locations:i,count:o}),s=0;s<i.length;s++){var c,d=i[s].querySelector('[itemprop="name"]')?i[s].querySelector('[itemprop="name"]').innerText:"",m=i[s].querySelector('[itemprop="latitude"]')?i[s].querySelector('[itemprop="latitude"]').innerText:"",p=i[s].querySelector('[itemprop="longitude"]')?i[s].querySelector('[itemprop="longitude"]').innerText:"",u=i[s].querySelector('[itemprop="streetAddress"]')?i[s].querySelector('[itemprop="streetAddress"]').innerText:"",g=i[s].querySelector('[itemprop="addressLocality"]')?i[s].querySelector('[itemprop="addressLocality"]').innerText:"",f=i[s].querySelector('[itemprop="telephone"]')?i[s].querySelector('[itemprop="telephone"]').innerText:"",h=i[s].querySelector("a.google"),y=h?h.href.slice(h.href.indexOf("?cid=")+5):"";(c=document.createElement("a")).name="location"+o+"-"+s,i[s].insertBefore(c,i[s].firstChild),t.data[o].push({marker:new google.maps.Marker({map:l.map,position:{lat:parseFloat(m),lng:parseFloat(p)},title:"Location details"}),info:new google.maps.InfoWindow({content:'<div class="ab-info-name"><strong>'+d+'</strong></div><div class="ab-c-info-street">'+u+'</div><div class="ab-c-info-locale">'+g+'</div><div class="ab-c-info-phone">'+t.labels[e.data.language].phone+": "+f+'</div><div class="ab-c-info-details"><a href="#location'+o+"-"+s+'">'+t.labels[e.data.language].details.replace("{name}",d)+"</a></div>"+(y?'<div class="ab-c-info-google"><a href="https://maps.google.com/?cid='+y+'" target="_blank">'+t.labels[e.data.language].google.replace("{name}","")+"</a></div>":"")}),li:i[s]}),(m>t.geometry[o][g].top||null==t.geometry[o][g].top)&&(t.geometry[o][g].top=m),(p<t.geometry[o][g].right||null==t.geometry[o][g].right)&&(t.geometry[o][g].right=p),(m<t.geometry[o][g].bottom||null==t.geometry[o][g].bottom)&&(t.geometry[o][g].bottom=m),(p>t.geometry[o][g].left||null==t.geometry[o][g].left)&&(t.geometry[o][g].left=p),t.data[o][s].marker.addListener("click",function(e,t,a){return function(){for(var o=0;o<e.data[t].length;o++)o==a?e.data[t][a].info.open(l.map,e.data[t][a].marker):e.data[t][o].info.close()}}(t,o,s));var b=document.createElement("button");b.appendChild(document.createTextNode(t.labels[e.data.language].marker.replace("{name}",d))),b.onclick=function(t,a,o,n,l,i){return function(){for(var r=0;r<t.data[a].length;r++)r==o?(t.data[a][r].marker.setVisible(!0),t.data[a][o].info.open(n.map,t.data[a][o].marker),n.map.setCenter(t.data[a][r].marker.getPosition()),n.map.setZoom(15),t.data[a][r].li.style.display="flex"):(t.data[a][r].marker.setVisible(!1),t.data[a][r].info.close(),t.data[a][r].li.style.display="none");l.filter.style.display="none",l.filtered.style.display="flex",l.filtered.firstChild.innerHTML=t.labels[e.data.language].showing.replace("{name}",i),location.href="#ab-locations"+a}}(t,o,s,l,r,d),i[s].querySelector("div.ab-c-location-footer").appendChild(b)}}},t.addFilter=function(a){e.settings.debug&&console.log("[abComponents] ui.locations.addFilter");for(var o=[],n=[],l=0;l<a.locations.length;l++){var i=a.locations[l].querySelector('[itemprop="addressLocality"]').innerText;-1==o.indexOf(i)&&(o.push(i),n[i]=0,t.geometry[a.count][i]={top:null,left:null,bottom:null,right:null}),n[i]+=1}o.sort();var r=document.createElement("div");r.className="ab-c-formbar";var s=document.createElement("form"),c=document.createElement("label");c.htmlFor="mapFilter"+a.count,c.appendChild(document.createTextNode(t.labels[e.data.language].select));var d=document.createElement("select");d.id="mapFilter"+a.count,d.className="ab-c-field",(p=document.createElement("option")).text="All locations",p.value="All",d.add(p);var m=document.createElement("optgroup");m.label="Cities",d.appendChild(m);for(l=0;l<o.length;l++){var p;(p=document.createElement("option")).text=o[l]+" - "+n[o[l]]+" "+(n[o[l]]>1?t.labels[e.data.language].locations:t.labels[e.data.language].location),p.value=o[l],m.appendChild(p)}var u,g=document.createElement("button");g.className="",g.appendChild(document.createTextNode(t.labels[e.data.language].update)),s.appendChild(c),s.appendChild(d),s.appendChild(g),r.appendChild(s),s.onsubmit=(u=a.locations,function(){for(var e=0;e<t.data[a.count].length;e++)if("All"==d.value){t.data[a.count][e].marker.setVisible(!0),t.data[a.count][e].info.close();var o=a.component.getAttribute("data-latitude")?parseFloat(a.component.getAttribute("data-latitude")):53.536673247532704,n=a.component.getAttribute("data-longitude")?parseFloat(a.component.getAttribute("data-longitude")):-113.50505621957399,l=a.component.getAttribute("data-zoom")?parseInt(a.component.getAttribute("data-zoom")):12;a.map.map.setCenter({lat:o,lng:n}),a.map.map.setZoom(l),t.data[a.count][e].li.style.display="flex"}else d.value==u[e].querySelector('[itemprop="addressLocality"]').innerText?(a.map.map.setCenter({lat:(parseFloat(t.geometry[a.count][d.value].top)+parseFloat(t.geometry[a.count][d.value].bottom))/2,lng:(parseFloat(t.geometry[a.count][d.value].left)+parseFloat(t.geometry[a.count][d.value].right))/2}),a.map.map.setZoom(10),t.data[a.count][e].marker.setVisible(!0),t.data[a.count][e].info.close(),t.data[a.count][e].li.style.display="flex"):(t.data[a.count][e].marker.setVisible(!1),t.data[a.count][e].info.close(),t.data[a.count][e].li.style.display="none");return!1});var f=document.createElement("form");f.style.display="none";var h=document.createElement("span");h.appendChild(document.createTextNode("Loading ..."));var y=document.createElement("button");return y.className="",y.appendChild(document.createTextNode(t.labels[e.data.language].clear)),f.onsubmit=function(e){return function(){s.style.display="flex",f.style.display="none";for(var o=0;o<t.data[a.count].length;o++)"All"==d.value?(1,t.data[a.count][o].marker.setVisible(!0),t.data[a.count][o].info.close(),t.data[a.count][o].li.style.display="flex"):d.value==e[o].querySelector('[itemprop="addressLocality"]').innerText?(1,t.data[a.count][o].marker.setVisible(!0),t.data[a.count][o].info.close(),t.data[a.count][o].li.style.display="flex"):(t.data[a.count][o].marker.setVisible(!1),t.data[a.count][o].info.close(),t.data[a.count][o].li.style.display="none");return!1}}(a.locations),f.appendChild(h),f.appendChild(y),r.appendChild(f),o.length>1&&a.component.insertBefore(r,a.component.firstChild),{filter:s,filtered:f}},t.addMap=function(t){e.settings.debug&&console.log("[abComponents] ui.locations.addMap");var a=t.component.getAttribute("data-latitude")?parseFloat(t.component.getAttribute("data-latitude")):53.536673247532704,o=t.component.getAttribute("data-longitude")?parseFloat(t.component.getAttribute("data-longitude")):-113.50505621957399,n=t.component.getAttribute("data-zoom")?parseInt(t.component.getAttribute("data-zoom")):12,l=document.createElement("div");return l.id="map"+t.count,l.className="ab-c-map",t.component.insertBefore(l,t.list),{container:l,map:new google.maps.Map(l,{center:{lat:a,lng:o},zoom:n,panControl:!1,mapTypeControl:!1,streetViewControl:!1})}}}},this.init=function(t){if(e.settings.debug&&console.log("[abComponents] init"),t.debug&&(e.settings.debug=!0),e.data.locations=document.querySelectorAll("div.ab-c-locations"),e.data.locations.length>0){var a=document.createElement("script");a.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDgDWjTlfR1LjJ74kvBfx8VDZ_ZamSos4M&callback=abComponents.ui.locations.init&language="+e.data.language.slice(0,2)+"&region="+e.data.language.slice(3,5),document.body.appendChild(a)}},function(){e.settings.debug&&console.log("[abComponents] constructor"),Array.indexOf||(Array.prototype.indexOf=function(e,t){var a=0;for(a=t||0;a<this.length;a++)if(this[a]==e)return a;return-1});var t=location.href.indexOf("?")>-1?location.href.slice(location.href.indexOf("?")+1).split("&"):new Array,a=[],o=0;for(o=0;o<t.length;o++)a=t[o].split("="),e.queryString[a[0]]=a[1];var n=document.querySelectorAll("html")[0];n.className=n.className.replace("nojs","js"),e.data.language=n.lang}()};